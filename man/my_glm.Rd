% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/myglm.R
\name{my_glm}
\alias{my_glm}
\title{Fit a Simplified Generalized Linear Model (Logistic Regression)}
\usage{
my_glm(
  formula,
  data,
  family = "binomial",
  link = "logit",
  tolerance = 1e-06,
  max_iter = 25
)
}
\arguments{
\item{formula}{An object of class \code{"formula"} (e.g., \code{y ~ x1 + x2}).}

\item{data}{A \code{data.frame} containing the variables in the model.}

\item{family}{A character string specifying the distribution family. Currently only \code{"binomial"} is supported.}

\item{link}{A character string specifying the link function. Currently only \code{"logit"} is supported.}

\item{tolerance}{A numeric value for the convergence tolerance (\code{max(|beta_new - beta|)}).}

\item{max_iter}{An integer specifying the maximum number of IRLS iterations.}
}
\value{
A list of class \code{"my_glm"} containing the following components:
\item{coefficients}{The estimated model coefficients.}
\item{v_cov}{The estimated variance-covariance matrix of the coefficients.}
\item{iterations}{The number of IRLS iterations performed.}
\item{converged}{Logical, TRUE if the IRLS algorithm converged within \code{max_iter}.}
\item{fitted.values}{The fitted mean values on the response scale (\eqn{\mu}).}
\item{linear.predictors}{The fitted linear predictors (\eqn{X\beta}).}
\item{residuals}{The raw residuals (\eqn{Y - \mu}).}
\item{logLik}{The final log-likelihood value for the fitted model.}
\item{AIC}{The calculated Akaike Information Criterion.}
\item{formula}{The model formula.}
\item{family}{The distribution family used.}
\item{link}{The link function used.}
}
\description{
Implements the Iteratively Reweighted Least Squares (IRLS) algorithm to fit
a Binary Logistic Regression model. **The core matrix algebra (X'WX) is optimized
using RcppArmadillo for significant performance gains.**
}
\details{
The function calculates coefficients by iteratively solving the weighted least
squares problem: \eqn{\beta^{(t+1)} = (X^T W^{(t)} X)^{-1} X^T W^{(t)} Z^{(t)}}.
**The calculation of \eqn{X^T W^{(t)} X} is delegated to an internal C++ function
powered by the Armadillo linear algebra library.**
Includes input validation and stabilization to prevent probabilities from reaching 0 or 1.
}
\examples{
set.seed(625)
n <- 200
X1 <- rnorm(n)
X2 <- rnorm(n)
X3 <- sample(0:1, n, replace = TRUE)
LP <- 0.5 + 1.2 * X1 - 0.8 * X2 + 0.6 * X3
Prob <- 1 / (1 + exp(-LP))
Y <- rbinom(n, 1, Prob)
df <- data.frame(Y, X1, X2, X3)

# Fit logistic regression using custom IRLS
my_model <- my_glm(Y ~ X1 + X2 + X3, data = df)

# View detailed summary
summary(my_model)

# Compare with base R glm
base_model <- glm(Y ~ X1 + X2 + X3, data = df, family = binomial(link = "logit"))

# Check for correctness (used in the vignette)
all.equal(my_model$coefficients, coef(base_model), tolerance = 1e-4)
}
\seealso{
\code{\link[stats]{glm}}, \code{\link[stats]{binomial}}
}
